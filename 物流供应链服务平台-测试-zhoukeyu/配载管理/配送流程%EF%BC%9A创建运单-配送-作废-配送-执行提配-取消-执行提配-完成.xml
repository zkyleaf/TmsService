<?xml version="1.0" encoding="UTF-8"?>
<con:testCase id="e8a0256e-72b4-4df8-82de-07e118bbaa52" discardOkResults="true" failOnError="true" failTestCaseOnErrors="true" keepSession="true" name="配送流程：创建运单-配送-作废-配送-执行提配-取消-执行提配-完成" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword="" disabled="true" maxResults="0" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="f3e33f2c-cf22-4042-8674-72d20fd49ac4fileName">配送流程%EF%BC%9A创建运单-配送-作废-配送-执行提配-取消-执行提配-完成</con:setting><con:setting id="e8a0256e-72b4-4df8-82de-07e118bbaa52fileName">配送流程%EF%BC%9A创建运单-配送-作废-配送-执行提配-取消-执行提配-完成</con:setting></con:settings><con:savedRecentRuns>1</con:savedRecentRuns><con:testStep type="properties" name="Properties" id="e29a61ab-37a6-4be8-bc7f-a979c3975d3f"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>loginName</con:name><con:value>emt56Ieq5Yqo5YyW5rWL6K+V6LSm5Y+3</con:value></con:property><con:property><con:name>password</con:name><con:value>emt5MTIzNDU2</con:value></con:property><con:property><con:name>mobileNumber</con:name><con:value/></con:property><con:property><con:name>currentWarehouseId</con:name><con:value>568040694</con:value></con:property><con:property><con:name>customerOrderNo</con:name><con:value>客户单号-zky自动化测试账号</con:value></con:property><con:property><con:name>账号：zky自动化测试账号  网点 568040694-网点A</con:name><con:value>只是说明账号</con:value></con:property><con:property><con:name>driverName</con:name><con:value>zhoukeyu</con:value></con:property><con:property><con:name>driverMobile</con:name><con:value>13575459073</con:value></con:property><con:property><con:name>driverId</con:name><con:value>568003517</con:value></con:property><con:property><con:name>carNum</con:name><con:value>浙AB3333</con:value></con:property><con:property><con:name>carId</con:name><con:value>82f0c588b39f4e2183b8d1fd2f80a9c2</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="datagen" name="DataGen" id="bf1ae5e8-9142-4abd-b758-8c9ae5a6c80e"><con:settings/><con:config xsi:type="con:DataGeneratorStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:property type="Script"><con:configuration><script>
def  realName="zky司机"+new Date().format("yyyyMMddHHmmss");</script></con:configuration><con:name>realName</con:name><con:mode>STEP</con:mode><con:shared>false</con:shared></con:property><con:property type="Script"><con:configuration><script>def  tf_timestamp=new Date().format("yyyyMMddHHmmss")</script></con:configuration><con:name>tf_timestamp</con:name><con:mode>STEP</con:mode><con:shared>false</con:shared></con:property><con:property type="Script"><con:configuration><script>def waybillNo=Math.random()*10000000</script></con:configuration><con:name>waybillNo</con:name><con:mode>STEP</con:mode><con:shared>false</con:shared></con:property><con:property type="Script"><con:configuration><script>def waybillNum=Math.random()*10000000</script></con:configuration><con:name>waybillNum</con:name><con:mode>STEP</con:mode><con:shared>false</con:shared></con:property><con:property type="Script"><con:configuration><script>def  NOW=new Date().format("yyyy-MM-dd HH:mm:ss")
</script></con:configuration><con:name>NOW</con:name><con:mode>STEP</con:mode><con:shared>false</con:shared></con:property></con:config></con:testStep><con:testStep type="groovy" name="tf_sign" id="0c70eb2b-1d2e-4ecd-b0d7-030f37f7e17c"><con:settings/><con:config><script><![CDATA[import java.io.UnsupportedEncodingException;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.Arrays;
import java.util.Map;
import groovy.json.JsonSlurper;

handleParamaters("会员登录","K77MFVhwk348J4h72nHi");

def void handleParamaters(String testStepName,String myKey)
{

	//如果没有有时间戳，请删除
	def time=new Date().format("yyyyMMddHHmmss")
	testRunner.testCase.getTestStepByName(testStepName).setPropertyValue("tf_timestamp",time)

	
	//自动获取参数
	List<String> list=testRunner.testCase.getTestStepByName(testStepName).getPropertyNames()
	Map<String, String> map = new HashMap<String, String>();
	for(int i=0;i<list.size();i++)
	{
//		if(!list.get(i).equals("RawRequest")&&list.get(i)!="ResponseAsXml"&&list.get(i)!="Domain"&&list.get(i)!="Password"&&list.get(i)!="Username"&&list.get(i)!="Response"&&list.get(i)!="Request"&&list.get(i)!="Endpoint"&&list.get(i)!="sign")
		if(!list.get(i).equals("RawRequest")&&list.get(i)!="ResponseAsXml"&&list.get(i)!="Domain"&&list.get(i)!="Password"&&list.get(i)!="Username"&&list.get(i)!="Response"&&list.get(i)!="Request"&&list.get(i)!="Endpoint"&&list.get(i)!="sign"&&list.get(i)!="HarResponse"&&list.get(i)!="RawResponse"&&list.get(i)!="callback"&&list.get(i)!="tf_ignore")
		{
			def res = context.expand(testRunner.testCase.getTestStepByName(testStepName).getPropertyValue(list.get(i)));
			log.info('res--------'+res);
			map.put(list.get(i),res);
		}
	}
	//加密
	String md5 = sign(map,myKey,"utf-8")
	//将加密值传给sign
	testRunner.testCase.getTestStepByName(testStepName).setPropertyValue("tf_sign",md5)
	
}

/**
	 * 签名字符串
	 * @param params
	 * @param key
	 * @param charset
	 * @return
	 */
def String sign(Map<String,String> params, String key, String charset) {

    	//1. tf_sign不加入签名
    	params.remove('tf_sign');
    	//2. 加入sk
    	params.put('dog_sk', key);
		//3. 对请求参数的值进行排序
		String keyString = createLinkString(params);
		//4. 生成md5
		return generateMd5(keyString, charset);
    }


    
    /**
     * 生成md5
     * @param key
     * @param charset
     * @return
     */
def String generateMd5(String keyString, String charset){
    	String result = '';
		try {
			MessageDigest md5 = MessageDigest.getInstance('MD5');
			md5.update(keyString.getBytes(charset));
			byte[] temp;
			temp = md5.digest(''.getBytes(charset));
			for (int i = 0; i < temp.length; i++) {
				result += Integer.toHexString(((int)0x000000ff & temp[i]) | (int)0xffffff00).substring(6);
			}	
			result = result.toUpperCase();
		} catch (NoSuchAlgorithmException e) {
			throw new RuntimeException('MD5签名过程中出现错误' + e);
		} catch (UnsupportedEncodingException e) {
			throw new RuntimeException('MD5签名过程中出现错误,指定的编码集不对,您目前指定的编码集是:' + charset);
		}    	
		return result;
    }




    /** 
     * 把数组所有元素排序，并参数值拼接成字符串
     * @param params 需要排序并参与字符拼接的参数组
     * @return 拼接后字符串
     */
def String createLinkString(Map<String, String> params) {
    	Object[] keys = params.keySet().toArray();
        Arrays.sort(keys);
        StringBuffer sb = new StringBuffer();
		for (int i = keys.length - 1; i >= 0; i--) {
			sb.append(params.get(keys[i]));
		}
        return sb.toString();
    }]]></script></con:config></con:testStep><con:testStep type="restrequest" name="会员登录" id="b568167a-fc8a-4b12-ba6e-f3d71555cfe5"><con:settings/><con:config service="http://10.7.28.14" resourcePath="/passport/partycommonmanage/webLogin" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="会员登录" id="c6591842-78d3-4cec-a58f-781e17e1fdd9" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://10.7.28.14</con:endpoint><con:request/><con:originalUri>http://10.7.28.14/passport/partycommonmanage/webLogin</con:originalUri><con:assertion type="JsonPath Match" id="4137c62e-8ae9-48f1-aa6f-5c56f9d39693" name="Match content of [msg]"><con:configuration><path>$.msg</path><content>success</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters>
  <con:entry key="tf_timestamp" value="20190104163048"/>
  <con:entry key="clientdfp" value="wertyuighf"/>
  <con:entry key="password" value="${Properties#password}"/>
  <con:entry key="loginName" value="${Properties#loginName}"/>
  <con:entry key="tf_sign" value="500789D998935A4659895BBCA4F5E9BE"/>
</con:parameters><con:parameterOrder><con:entry>dog_ak</con:entry><con:entry>sourcecode</con:entry><con:entry>tf_timestamp</con:entry><con:entry>clientdfp</con:entry><con:entry>tf_ignore</con:entry><con:entry>loginName</con:entry><con:entry>password</con:entry><con:entry>clientIp</con:entry><con:entry>tf_sign</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="cookies" id="2eefeaa8-331a-441b-a045-a8880cc941e2"><con:settings/><con:config><script>import net.sf.json.JSONObject;
import com.eviware.soapui.support.types.StringToStringMap

//获取token
String data = context.expand( '${会员登录#Response#$.data}' )
JSONObject json=JSONObject.fromObject(data)
log.info(json);
String token1="session_key="+json.getString('session_key');
//log.info("session_key的值为：" + token);
String warehousekey="_warehouse_key="+'568028583';

log.info("warehousekey"+warehousekey);
String token=token1+";"+warehousekey;
log.info("token"+token);

//设置map
HashMap&lt;String,String> hashmap1=new HashMap&lt;String,String>()
hashmap1.put('Cookie',token1)
StringToStringMap cookieMap1 = new StringToStringMap(hashmap1)
log.info("cookieMap1"+cookieMap1);

//设置map +warehousekey
HashMap&lt;String,String> hashmap=new HashMap&lt;String,String>()
hashmap.put('Cookie',token)
StringToStringMap cookieMap = new StringToStringMap(hashmap)
log.info("cookieMap"+cookieMap);
//设置cookie
testRunner.testCase.getTestStepByName("csrfToken").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("切换网点").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("创建运单-配送-3个计划").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("配送-查询未出库计划单").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("创建配送").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("作废配送单").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("再次创建配送").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("执行提配").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("取消提配").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("执行提配2").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("提配完成").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("配送-查询未出库计划单-配送完成").testRequest.setRequestHeaders(cookieMap1);
testRunner.testCase.getTestStepByName("运单初始化").testRequest.setRequestHeaders(cookieMap1);




//设置cookie  ： sessionkey+warehousekey
//testRunner.testCase.getTestStepByName("查询司机列表").testRequest.setRequestHeaders(cookieMap);
</script></con:config></con:testStep><con:testStep type="restrequest" name="csrfToken" id="88f3f0fc-3101-4a14-9556-6f22dff80f65"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/csrfTokenServlet" methodName="获取csrfToken" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="csrfToken" id="99fd653c-4388-4e64-9456-a5c596410372" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request/><con:originalUri>http://10.77.0.147/scTmsWeb/csrfTokenServlet</con:originalUri><con:assertion type="JsonPath Match" id="fa93f2c2-86f7-4041-af19-60c19d853533" name="Match content of [result]"><con:configuration><path>$.result</path><content>success</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters/><con:parameterOrder/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="切换网点" id="d7a08374-77c8-4fd8-916d-bcf81602cb0b"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/warehouse/changeCurrentWarehouse" methodName="切换网点" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="切换网点" id="aa421939-b243-432f-8602-ac01462e4092" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>http://10.77.0.147</con:endpoint><con:request>{"currentWarehouseId":${Properties#currentWarehouseId}}</con:request><con:originalUri>http://10.77.0.147/scTmsWeb/warehouse/changeCurrentWarehouse</con:originalUri><con:assertion type="JsonPath Match" id="5a2815ed-1435-4c3d-8461-1b6e51557c14" name="Match content of [msg]"><con:configuration><path>$.msg</path><content>success</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><entry key="csrfToken" value="${csrfToken#Response#$.data}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="运单初始化" id="fce7220b-2868-40c2-9204-0d8a799f5f21"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/waybill/initWaybill" methodName="运单初始化" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="运单初始化" id="072dbf4f-1dca-4564-8f9c-832cb0839b39" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request/><con:originalUri>http://10.77.0.147/scTmsWeb/waybill/initWaybill</con:originalUri><con:assertion type="GroovyScriptAssertion" id="f426bf05-9a44-49bd-b842-de5ff72cb821" name="Assert node [body]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def responsemsg = context.expand( '${运单初始化#Response#$.msg}' )

assert responsemsg=='success'

</scriptText></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><entry key="csrfToken" value="${csrfToken#Response#$.data}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="创建运单-配送-3个计划" id="367f58ea-37a2-4a93-83a8-77e971f740bc"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/waybill/createWaybill" methodName="创建运单" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="创建运单-配送-3个计划" id="43e391bd-7f08-445f-a44e-6eca47701b24" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request>{
    "waybillNo":"${运单初始化#Response#$.data.waybillNo}",
    "waybillNum":"${运单初始化#Response#$.data.waybillNum}",
    "endAddressPoi":"合肥市",
    "deliveryDate":"2019-01-04 10:33:14",
    "account":"",
    "mobile":"",
    "idCardNumber":"",
    "receiptPartyId":"",
    "bank":"",
    "bankCard":"",
    "bankProvince":"",
    "bankCity":"",
    "bankBranch":"",
    "updateVersion":"",
    "transferWarehouseId":568040694,
    "transferWarehouseName":"网点A0104",
    "endWarehouseId":568040695,
    "endWarehouseName":"网点B0104",
    "startAddress":"浙江省",
    "endAddress":"合肥市",
    "customerOrderNo":"${Properties#customerOrderNo}",
    "goodsCode":"19010400000068-30",
    "agent":"zky自动化测试账号",
    "receiptMethod":"1",
    "deliveryMethod":"1",
    "payMethod":"现付",
    "senderId":568040713,
    "senderName":"zky发货人",
    "sendIDCardNo":"",
    "senderPhone":"13575458888",
    "senderAddress":"北京市市辖区东城区",
    "senderFullAddress":"周科玉测试SoapUI发货地址1",
    "senderProvince":"北京市",
    "senderCity":"市辖区",
    "senderRegion":"东城区",
    "senderStreet":"",
    "senderPoi":"110101",
    "receiverId":"",
    "receiverName":"zky收货人",
    "receiverPhone":"13575459999",
    "receiverAddress":"浙江省杭州市上城区",
    "receiverFullAddress":"周科玉测试SoapUI收货地址2",
    "receiverProvince":"浙江省",
    "receiverCity":"杭州市",
    "receiverRegion":"上城区",
    "receiverStreet":"",
    "receiverPoi":"330102",
    "pickMethod":"0",
    "controlGoods":"0",
    "infoStatus":"0",
    "wayFee":500,
    "goodsValue":"0",
    "goodsCustomValue":"0",
    "packingFee":"0",
    "deliveryPayFee":"0",
    "predictTransitFee":"0",
    "predictDeliveryPayFee":"0",
    "upstairsFee":"0",
    "takePayFee":"0",
    "returnFee":"0",
    "otherFee":"0",
    "deliverWarehouseFee":"0",
    "infoFee":"0",
    "agentFee":"0",
    "agentExtractFee":"0",
    "childReturnFee":"0",
    "agentType":"非传化",
    "receiptAccountType":"",
    "sendPayFee":500,
    "receivePayFee":"0",
    "returnPayFee":"0",
    "monthClearing":"0",
    "oilCardPayFee":"0",
    "receiptNum":1,
    "remark":"SoapUI自动化测试接口使用111",
    "codType":"",
    "wayFeeBase":0,
    "deliveryPayFeeBase":0,
    "takePayFeeBase":0,
    "weightUnit":"t",
    "sendLatitude":0,
    "sendLongitude":0,
    "receiverLatitude":0,
    "receiverLongitude":0,
    "isReturnGoods":"0",
    "termialNo":"",
    "manufacturer":"",
    "senderOrganization":"",
    "receiverOrganization":"",
    "utGoodsDTOList":[
  {
         "k": 0,
         "goodsName": "soapui自动化测试货物1",
         "goodsNumber": "1",
         "goodsWeight": 1000,
         "goodsVolume": 1,
         "goodsType": "1",
         "goodsPackage": "1",
         "goodsValue": 1,
         "goodsNumberUnit": "0"
      },
            {
         "k": 0.4407588932989914,
         "goodsName": "soapui自动化测试货物2",
         "goodsNumber": "2",
         "goodsWeight": 2000,
         "goodsVolume": 2,
         "goodsType": "2",
         "goodsPackage": "2",
         "goodsValue": 2,
         "goodsNumberUnit": "0"
      },
            {
         "k": 0.5688828012286893,
         "goodsName": "soapui自动化测试货物3",
         "goodsNumber": "3",
         "goodsWeight": 3000,
         "goodsVolume": 3,
         "goodsType": "3",
         "goodsPackage": "3",
         "goodsValue": 3,
         "goodsNumberUnit": "0"
      }
    ]
}</con:request><con:originalUri>http://10.77.0.147/scTmsWeb/waybill/createWaybill</con:originalUri><con:assertion type="GroovyScriptAssertion" id="8c188d8d-8a20-4f57-9fac-e233d465624c" name="Assert node [body]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def responsemsg = context.expand( '${创建运单-配送-3个计划#Response#$.msg}' )


assert responsemsg == 'success'
</scriptText></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><entry key="csrfToken" value="${csrfToken#Response#$.data}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="配送-查询未出库计划单" id="578aea73-9be4-45b0-ae84-0d80e617d80f"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/scWebDelivery/queryDeliveryWaybillPlan" methodName="配送-查询未出库计划运单" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="配送-查询未出库计划单" id="c7e449fa-b558-483e-997d-3bf9ff549ba2" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request/><con:originalUri>http://10.77.0.147/scTmsWeb/scWebDelivery/queryDeliveryWaybillPlan</con:originalUri><con:assertion type="GroovyScriptAssertion" id="41f1f4f9-531f-474e-a5be-fc72d36e9db7" name="Assert node [body]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def responsemsg = context.expand( '${配送-查询未出库计划单#Response#$.msg}' )


assert responsemsg =='success'
</scriptText></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters>
  <con:entry key="csrfToken" value="${csrfToken#Response#$.data}"/>
  <con:entry key="keywords" value="${运单初始化#Response#$.data.waybillNo}"/>
</con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry><con:entry>keywords</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="创建配送" id="4328d9e8-05ea-489c-ac43-209c93bef2a9"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/scWebDelivery/createDelivery" methodName="新建提货" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="创建配送" id="2ee78fba-03a2-4aed-8234-4233b1dbd7dc" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request>{
    "type":3,
    "waybillPlanList":[
        {
            "arrivalWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[0].arrivalWarehouseId},
            "arrivalWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[0].arrivalWarehouseName}",
            "customerOrderNo":"${配送-查询未出库计划单#Response#$.data[0].children[0].customerOrderNo}",
            "deliveryMethod":"1",
            "directSending":"1",
            "externalPlanNumber":"${配送-查询未出库计划单#Response#$.data[0].children[0].externalPlanNumber}",
            "goodsCode":"${配送-查询未出库计划单#Response#$.data[0].children[0].goodsCode}",
            "goodsName":"${配送-查询未出库计划单#Response#$.data[0].children[0].goodsName}",
            "goodsNum":"${配送-查询未出库计划单#Response#$.data[0].children[0].goodsNum}",
            "goodsPackage":"${配送-查询未出库计划单#Response#$.data[0].children[0].goodsPackage}",
            "goodsType":"${配送-查询未出库计划单#Response#$.data[0].children[0].goodsType}",
            "loadAmount":1,
            "loadVolume":1,
            "loadWeight":1000,
            "orderNum":"${配送-查询未出库计划单#Response#$.data[0].children[0].orderNum}",
            "outBoundGoodsId":${配送-查询未出库计划单#Response#$.data[0].children[0].outBoundGoodsId},
            "outBoundStatus":"${配送-查询未出库计划单#Response#$.data[0].children[0].outBoundStatus},",
            "planAmount":1,
            "planNum":"",
            "planVolume":1,
            "planWeight":1000,
              "receiverAddress":"${配送-查询未出库计划单#Response#$.data[0].children[0].receiverAddress}",
            "receiverId":${配送-查询未出库计划单#Response#$.data[0].children[0].receiverId},
            "receiverName":"${配送-查询未出库计划单#Response#$.data[0].children[0].receiverPhone}",
            "receiverPhone":"${配送-查询未出库计划单#Response#$.data[0].children[0].receiverName}",
           "senderAddress":"${配送-查询未出库计划单#Response#$.data[0].children[0].senderAddress}",
            "senderId":${配送-查询未出库计划单#Response#$.data[0].children[0].senderId},
            "senderName":"${配送-查询未出库计划单#Response#$.data[0].children[0].senderName}",
            "senderPhone":"${配送-查询未出库计划单#Response#$.data[0].children[0].senderPhone}",
          "startWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[0].startWarehouseId},
            "startWarehouseName":"接口测试网点1",
            "startWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[0].startWarehouseName}",
            "tradeNum":"",
            "transfarFee":null,
            "transferFeePayMethod":"",
            "transportCost":"1.68",
            "transportNum":"",
            "waybillNo":"${配送-查询未出库计划单#Response#$.data[0].children[0].waybillNo}",
            "waybillNum":"${配送-查询未出库计划单#Response#$.data[0].children[0].waybillNum}",
            "key":"${配送-查询未出库计划单#Response#$.data[0].children[0].externalPlanNumber}-${配送-查询未出库计划单#Response#$.data[0].children[0].outBoundGoodsId}",
            "parentKey":"${配送-查询未出库计划单#Response#$.data[0].children[0].waybillNo}",
            "actionType":"create",
            "totalAmount":1
        },
          {
            "arrivalWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[1].arrivalWarehouseId},
            "arrivalWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[1].arrivalWarehouseName}",
            "customerOrderNo":"${配送-查询未出库计划单#Response#$.data[0].children[1].customerOrderNo}",
            "deliveryMethod":"1",
            "directSending":"1",
            "externalPlanNumber":"${配送-查询未出库计划单#Response#$.data[0].children[1].externalPlanNumber}",
            "goodsCode":"${配送-查询未出库计划单#Response#$.data[0].children[1].goodsCode}",
            "goodsName":"${配送-查询未出库计划单#Response#$.data[0].children[1].goodsName}",
            "goodsNum":"${配送-查询未出库计划单#Response#$.data[0].children[1].goodsNum}",
            "goodsPackage":"${配送-查询未出库计划单#Response#$.data[0].children[1].goodsPackage}",
            "goodsType":"${配送-查询未出库计划单#Response#$.data[0].children[1].goodsType}",
            "loadAmount":2,
            "loadVolume":2,
            "loadWeight":2000,
            "orderNum":"${配送-查询未出库计划单#Response#$.data[0].children[1].orderNum}",
            "outBoundGoodsId":${配送-查询未出库计划单#Response#$.data[0].children[1].outBoundGoodsId},
            "outBoundStatus":"${配送-查询未出库计划单#Response#$.data[0].children[1].outBoundStatus},",
            "planAmount":2,
            "planNum":"",
            "planVolume":2,
            "planWeight":2000,
              "receiverAddress":"${配送-查询未出库计划单#Response#$.data[0].children[1].receiverAddress}",
            "receiverId":${配送-查询未出库计划单#Response#$.data[0].children[1].receiverId},
            "receiverName":"${配送-查询未出库计划单#Response#$.data[0].children[1].receiverPhone}",
            "receiverPhone":"${配送-查询未出库计划单#Response#$.data[0].children[1].receiverName}",
           "senderAddress":"${配送-查询未出库计划单#Response#$.data[0].children[1].senderAddress}",
            "senderId":${配送-查询未出库计划单#Response#$.data[0].children[1].senderId},
            "senderName":"${配送-查询未出库计划单#Response#$.data[0].children[1].senderName}",
            "senderPhone":"${配送-查询未出库计划单#Response#$.data[0].children[1].senderPhone}",
          "startWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[1].startWarehouseId},
            "startWarehouseName":"接口测试网点1",
            "startWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[1].startWarehouseName}",
            "tradeNum":"",
            "transfarFee":null,
            "transferFeePayMethod":"",
            "transportCost":"3.37",
            "transportNum":"",
            "waybillNo":"${配送-查询未出库计划单#Response#$.data[0].children[1].waybillNo}",
            "waybillNum":"${配送-查询未出库计划单#Response#$.data[0].children[1].waybillNum}",
            "key":"${配送-查询未出库计划单#Response#$.data[0].children[1].externalPlanNumber}-${配送-查询未出库计划单#Response#$.data[0].children[1].outBoundGoodsId}",
            "parentKey":"${配送-查询未出库计划单#Response#$.data[0].children[1].waybillNo}",
            "actionType":"create",
            "totalAmount":2
        },
          {
            "arrivalWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[2].arrivalWarehouseId},
            "arrivalWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[2].arrivalWarehouseName}",
            "customerOrderNo":"${配送-查询未出库计划单#Response#$.data[0].children[2].customerOrderNo}",
            "deliveryMethod":"1",
            "directSending":"1",
            "externalPlanNumber":"${配送-查询未出库计划单#Response#$.data[0].children[2].externalPlanNumber}",
            "goodsCode":"${配送-查询未出库计划单#Response#$.data[0].children[2].goodsCode}",
            "goodsName":"${配送-查询未出库计划单#Response#$.data[0].children[2].goodsName}",
            "goodsNum":"${配送-查询未出库计划单#Response#$.data[0].children[2].goodsNum}",
            "goodsPackage":"${配送-查询未出库计划单#Response#$.data[0].children[2].goodsPackage}",
            "goodsType":"${配送-查询未出库计划单#Response#$.data[0].children[2].goodsType}",
            "loadAmount":3,
            "loadVolume":3,
            "loadWeight":3000,
            "orderNum":"${配送-查询未出库计划单#Response#$.data[0].children[2].orderNum}",
            "outBoundGoodsId":${配送-查询未出库计划单#Response#$.data[0].children[2].outBoundGoodsId},
            "outBoundStatus":"${配送-查询未出库计划单#Response#$.data[0].children[2].outBoundStatus},",
            "planAmount":3,
            "planNum":"",
            "planVolume":3,
            "planWeight":3000,
              "receiverAddress":"${配送-查询未出库计划单#Response#$.data[0].children[2].receiverAddress}",
            "receiverId":${配送-查询未出库计划单#Response#$.data[0].children[2].receiverId},
            "receiverName":"${配送-查询未出库计划单#Response#$.data[0].children[2].receiverPhone}",
            "receiverPhone":"${配送-查询未出库计划单#Response#$.data[0].children[2].receiverName}",
           "senderAddress":"${配送-查询未出库计划单#Response#$.data[0].children[2].senderAddress}",
            "senderId":${配送-查询未出库计划单#Response#$.data[0].children[2].senderId},
            "senderName":"${配送-查询未出库计划单#Response#$.data[0].children[2].senderName}",
            "senderPhone":"${配送-查询未出库计划单#Response#$.data[0].children[2].senderPhone}",
          "startWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[2].startWarehouseId},
            "startWarehouseName":"接口测试网点1",
            "startWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[2].startWarehouseName}",
            "tradeNum":"",
            "transfarFee":null,
            "transferFeePayMethod":"",
            "transportCost":"5.05",
            "transportNum":"",
            "waybillNo":"${配送-查询未出库计划单#Response#$.data[0].children[2].waybillNo}",
            "waybillNum":"${配送-查询未出库计划单#Response#$.data[0].children[2].waybillNum}",
            "key":"${配送-查询未出库计划单#Response#$.data[0].children[2].externalPlanNumber}-${配送-查询未出库计划单#Response#$.data[0].children[2].outBoundGoodsId}",
            "parentKey":"${配送-查询未出库计划单#Response#$.data[0].children[2].waybillNo}",
            "actionType":"create",
            "totalAmount":3
        }
    ],
    "remark":"自动化接口zky测试新增配送 3个计划单  哈哈哈哈啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊为了增加长度哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈或或123445555555555555",
     "driverName":"司机21",
    "driverMobile":"15067559921",
    "driverId":568036627,
    "carId":"e82992a545d64567b8ad271f70203b7c",
    "carNum":"浙CC2345",
   "startTime": "${DataGen#NOW}",
    "transportTotalCost":12
}
</con:request><con:originalUri>http://10.77.0.147/scTmsWeb/scWebDelivery/createDelivery</con:originalUri><con:assertion type="GroovyScriptAssertion" id="9146e8cb-c3a4-44bc-8326-7d8a0b50287d" name="Assert node [body]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def responsemsg = context.expand( '${创建配送#Response#$.msg}' )


assert responsemsg == 'success'
</scriptText></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><entry key="csrfToken" value="${csrfToken#Response#$.data}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="作废配送单" id="127e6871-77ef-498a-992c-3ed55edc550d"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/scWebDelivery/deleteDelivery" methodName="作废提货单" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="作废配送单" id="3fbbc171-4461-40bd-bb84-4a267563110b" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request>{transportNum: "${创建配送#Response#$.data}", type: "3"}</con:request><con:originalUri>http://10.77.0.147/scTmsWeb/scWebDelivery/deleteDelivery</con:originalUri><con:assertion type="GroovyScriptAssertion" id="32dc0ad3-56dc-4509-a7c5-839b9ed2c932" name="Assert node [body]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder
def responsemsg = context.expand( '${作废配送单#Response#$.msg}' )


assert responsemsg == 'success'
</scriptText></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><entry key="csrfToken" value="${csrfToken#Response#$.data}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="数据库校验-ut_transport表状态 配送已作废" id="e1d951b5-573c-4363-aaa1-a1deb43ecd69"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>bu_transport</con:dbConnectionName><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://10.7.13.48:8066/bu_transport?user=admin&amp;password=PASS_VALUE</con:connectionString><con:password>9MeRMf7b15SvsjLpQFtB</con:password><con:query>Select *
From ut_transport where ut_transport.transport_num='${创建配送#Response#$.data}'</con:query><con:assertion type="XPath Match" id="3d25d997-7c42-472d-935d-c8e93e860fd1" name="Match content of [ut_transport.transport_status]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/ut_transport.transport_status[1]/text()</path><content>20</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="XPath Match" id="94515164-018d-4cee-85cc-f8fee59ae113" name="Match content of [ut_transport.is_deleted]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/ut_transport.is_deleted[1]/text()</path><content>1</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="restrequest" name="再次创建配送" id="2cd6d5c8-87cc-4cf0-87d5-0bdcc48dad69"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/scWebDelivery/createDelivery" methodName="新建提货" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="再次创建配送" id="2ee78fba-03a2-4aed-8234-4233b1dbd7dc" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request>{
    "type":3,
    "waybillPlanList":[
        {
            "arrivalWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[0].arrivalWarehouseId},
            "arrivalWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[0].arrivalWarehouseName}",
            "customerOrderNo":"${配送-查询未出库计划单#Response#$.data[0].children[0].customerOrderNo}",
            "deliveryMethod":"1",
            "directSending":"1",
            "externalPlanNumber":"${配送-查询未出库计划单#Response#$.data[0].children[0].externalPlanNumber}",
            "goodsCode":"${配送-查询未出库计划单#Response#$.data[0].children[0].goodsCode}",
            "goodsName":"${配送-查询未出库计划单#Response#$.data[0].children[0].goodsName}",
            "goodsNum":"${配送-查询未出库计划单#Response#$.data[0].children[0].goodsNum}",
            "goodsPackage":"${配送-查询未出库计划单#Response#$.data[0].children[0].goodsPackage}",
            "goodsType":"${配送-查询未出库计划单#Response#$.data[0].children[0].goodsType}",
            "loadAmount":1,
            "loadVolume":1,
            "loadWeight":1000,
            "orderNum":"${配送-查询未出库计划单#Response#$.data[0].children[0].orderNum}",
            "outBoundGoodsId":${配送-查询未出库计划单#Response#$.data[0].children[0].outBoundGoodsId},
            "outBoundStatus":"${配送-查询未出库计划单#Response#$.data[0].children[0].outBoundStatus},",
            "planAmount":1,
            "planNum":"",
            "planVolume":1,
            "planWeight":1000,
              "receiverAddress":"${配送-查询未出库计划单#Response#$.data[0].children[0].receiverAddress}",
            "receiverId":${配送-查询未出库计划单#Response#$.data[0].children[0].receiverId},
            "receiverName":"${配送-查询未出库计划单#Response#$.data[0].children[0].receiverPhone}",
            "receiverPhone":"${配送-查询未出库计划单#Response#$.data[0].children[0].receiverName}",
           "senderAddress":"${配送-查询未出库计划单#Response#$.data[0].children[0].senderAddress}",
            "senderId":${配送-查询未出库计划单#Response#$.data[0].children[0].senderId},
            "senderName":"${配送-查询未出库计划单#Response#$.data[0].children[0].senderName}",
            "senderPhone":"${配送-查询未出库计划单#Response#$.data[0].children[0].senderPhone}",
          "startWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[0].startWarehouseId},
            "startWarehouseName":"接口测试网点1",
            "startWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[0].startWarehouseName}",
            "tradeNum":"",
            "transfarFee":null,
            "transferFeePayMethod":"",
            "transportCost":"1.68",
            "transportNum":"",
            "waybillNo":"${配送-查询未出库计划单#Response#$.data[0].children[0].waybillNo}",
            "waybillNum":"${配送-查询未出库计划单#Response#$.data[0].children[0].waybillNum}",
            "key":"${配送-查询未出库计划单#Response#$.data[0].children[0].externalPlanNumber}-${配送-查询未出库计划单#Response#$.data[0].children[0].outBoundGoodsId}",
            "parentKey":"${配送-查询未出库计划单#Response#$.data[0].children[0].waybillNo}",
            "actionType":"create",
            "totalAmount":1
        },
          {
            "arrivalWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[1].arrivalWarehouseId},
            "arrivalWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[1].arrivalWarehouseName}",
            "customerOrderNo":"${配送-查询未出库计划单#Response#$.data[0].children[1].customerOrderNo}",
            "deliveryMethod":"1",
            "directSending":"1",
            "externalPlanNumber":"${配送-查询未出库计划单#Response#$.data[0].children[1].externalPlanNumber}",
            "goodsCode":"${配送-查询未出库计划单#Response#$.data[0].children[1].goodsCode}",
            "goodsName":"${配送-查询未出库计划单#Response#$.data[0].children[1].goodsName}",
            "goodsNum":"${配送-查询未出库计划单#Response#$.data[0].children[1].goodsNum}",
            "goodsPackage":"${配送-查询未出库计划单#Response#$.data[0].children[1].goodsPackage}",
            "goodsType":"${配送-查询未出库计划单#Response#$.data[0].children[1].goodsType}",
            "loadAmount":2,
            "loadVolume":2,
            "loadWeight":2000,
            "orderNum":"${配送-查询未出库计划单#Response#$.data[0].children[1].orderNum}",
            "outBoundGoodsId":${配送-查询未出库计划单#Response#$.data[0].children[1].outBoundGoodsId},
            "outBoundStatus":"${配送-查询未出库计划单#Response#$.data[0].children[1].outBoundStatus},",
            "planAmount":2,
            "planNum":"",
            "planVolume":2,
            "planWeight":2000,
              "receiverAddress":"${配送-查询未出库计划单#Response#$.data[0].children[1].receiverAddress}",
            "receiverId":${配送-查询未出库计划单#Response#$.data[0].children[1].receiverId},
            "receiverName":"${配送-查询未出库计划单#Response#$.data[0].children[1].receiverPhone}",
            "receiverPhone":"${配送-查询未出库计划单#Response#$.data[0].children[1].receiverName}",
           "senderAddress":"${配送-查询未出库计划单#Response#$.data[0].children[1].senderAddress}",
            "senderId":${配送-查询未出库计划单#Response#$.data[0].children[1].senderId},
            "senderName":"${配送-查询未出库计划单#Response#$.data[0].children[1].senderName}",
            "senderPhone":"${配送-查询未出库计划单#Response#$.data[0].children[1].senderPhone}",
          "startWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[1].startWarehouseId},
            "startWarehouseName":"接口测试网点1",
            "startWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[1].startWarehouseName}",
            "tradeNum":"",
            "transfarFee":null,
            "transferFeePayMethod":"",
            "transportCost":"3.37",
            "transportNum":"",
            "waybillNo":"${配送-查询未出库计划单#Response#$.data[0].children[1].waybillNo}",
            "waybillNum":"${配送-查询未出库计划单#Response#$.data[0].children[1].waybillNum}",
            "key":"${配送-查询未出库计划单#Response#$.data[0].children[1].externalPlanNumber}-${配送-查询未出库计划单#Response#$.data[0].children[1].outBoundGoodsId}",
            "parentKey":"${配送-查询未出库计划单#Response#$.data[0].children[1].waybillNo}",
            "actionType":"create",
            "totalAmount":2
        },
          {
            "arrivalWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[2].arrivalWarehouseId},
            "arrivalWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[2].arrivalWarehouseName}",
            "customerOrderNo":"${配送-查询未出库计划单#Response#$.data[0].children[2].customerOrderNo}",
            "deliveryMethod":"1",
            "directSending":"1",
            "externalPlanNumber":"${配送-查询未出库计划单#Response#$.data[0].children[2].externalPlanNumber}",
            "goodsCode":"${配送-查询未出库计划单#Response#$.data[0].children[2].goodsCode}",
            "goodsName":"${配送-查询未出库计划单#Response#$.data[0].children[2].goodsName}",
            "goodsNum":"${配送-查询未出库计划单#Response#$.data[0].children[2].goodsNum}",
            "goodsPackage":"${配送-查询未出库计划单#Response#$.data[0].children[2].goodsPackage}",
            "goodsType":"${配送-查询未出库计划单#Response#$.data[0].children[2].goodsType}",
            "loadAmount":3,
            "loadVolume":3,
            "loadWeight":3000,
            "orderNum":"${配送-查询未出库计划单#Response#$.data[0].children[2].orderNum}",
            "outBoundGoodsId":${配送-查询未出库计划单#Response#$.data[0].children[2].outBoundGoodsId},
            "outBoundStatus":"${配送-查询未出库计划单#Response#$.data[0].children[2].outBoundStatus},",
            "planAmount":3,
            "planNum":"",
            "planVolume":3,
            "planWeight":3000,
              "receiverAddress":"${配送-查询未出库计划单#Response#$.data[0].children[2].receiverAddress}",
            "receiverId":${配送-查询未出库计划单#Response#$.data[0].children[2].receiverId},
            "receiverName":"${配送-查询未出库计划单#Response#$.data[0].children[2].receiverPhone}",
            "receiverPhone":"${配送-查询未出库计划单#Response#$.data[0].children[2].receiverName}",
           "senderAddress":"${配送-查询未出库计划单#Response#$.data[0].children[2].senderAddress}",
            "senderId":${配送-查询未出库计划单#Response#$.data[0].children[2].senderId},
            "senderName":"${配送-查询未出库计划单#Response#$.data[0].children[2].senderName}",
            "senderPhone":"${配送-查询未出库计划单#Response#$.data[0].children[2].senderPhone}",
          "startWarehouseId":${配送-查询未出库计划单#Response#$.data[0].children[2].startWarehouseId},
            "startWarehouseName":"接口测试网点1",
            "startWarehouseName":"${配送-查询未出库计划单#Response#$.data[0].children[2].startWarehouseName}",
            "tradeNum":"",
            "transfarFee":null,
            "transferFeePayMethod":"",
            "transportCost":"5.05",
            "transportNum":"",
            "waybillNo":"${配送-查询未出库计划单#Response#$.data[0].children[2].waybillNo}",
            "waybillNum":"${配送-查询未出库计划单#Response#$.data[0].children[2].waybillNum}",
            "key":"${配送-查询未出库计划单#Response#$.data[0].children[2].externalPlanNumber}-${配送-查询未出库计划单#Response#$.data[0].children[2].outBoundGoodsId}",
            "parentKey":"${配送-查询未出库计划单#Response#$.data[0].children[2].waybillNo}",
            "actionType":"create",
            "totalAmount":3
        }
    ],
    "remark":"自动化接口zky测试新增配送 3个计划单  哈哈哈哈啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊啊为了增加长度哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈或或123445555555555555",
     "driverName":"司机21",
    "driverMobile":"15067559921",
    "driverId":568036627,
    "carId":"e82992a545d64567b8ad271f70203b7c",
    "carNum":"浙CC2345",
   "startTime": "${DataGen#NOW}",
    "transportTotalCost":12
}
</con:request><con:originalUri>http://10.77.0.147/scTmsWeb/scWebDelivery/createDelivery</con:originalUri><con:assertion type="GroovyScriptAssertion" id="11066d74-b9fc-47b0-a05c-d76564b509cf" name="Assert node [body]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def responsemsg = context.expand( '${再次创建配送#Response#$.msg}' )


assert responsemsg == 'success'
</scriptText></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><entry key="csrfToken" value="${csrfToken#Response#$.data}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="配送-查询未出库计划单-配送完成" id="701f2001-bffd-47dc-897b-a2cda9bc39a9"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/scWebDelivery/queryDeliveryWaybillPlan" methodName="配送-查询未出库计划运单" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="配送-查询未出库计划单-配送完成" id="c7e449fa-b558-483e-997d-3bf9ff549ba2" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request/><con:originalUri>http://10.77.0.147/scTmsWeb/scWebDelivery/queryDeliveryWaybillPlan</con:originalUri><con:assertion type="GroovyScriptAssertion" id="216383de-58b9-40d2-9188-6aed04b7ef56" name="Assert node [body]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def responsemsg = context.expand( '${配送-查询未出库计划单-配送完成#Response#$.msg}' )
def responsedata = context.expand( '${配送-查询未出库计划单-配送完成#Response#$.data}' )


assert responsemsg == 'success'
assert responsedata=='[]'
</scriptText></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters>
  <con:entry key="csrfToken" value="${csrfToken#Response#$.data}"/>
  <con:entry key="keywords" value="${DataGen#waybillNo}"/>
</con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry><con:entry>keywords</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="执行提配" id="9cd1755a-640c-4371-9841-5a2780233fc9"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/scWebDelivery/executionDepart" methodName="执行提配" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="执行提配" id="87b3e451-0d95-44ca-83ad-ec29545855df" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request>{
	"transportNum":"${再次创建配送#Response#$.data}",
	"type":"3"
	}</con:request><con:originalUri>http://10.77.0.147/scTmsWeb/scWebDelivery/executionDepart</con:originalUri><con:assertion type="GroovyScriptAssertion" id="1f347b3a-0c83-4eb6-b52a-dc99620c201f" name="Assert node [body]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def responsemsg = context.expand( '${执行提配#Response#$.msg}' )

assert responsemsg =='success'
</scriptText></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><entry key="csrfToken" value="${csrfToken#Response#$.data}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="取消提配" id="65643f2d-91bc-41ff-becc-ddc2618bf550"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/scWebDelivery/cancelExecutionDepart" methodName="取消提配" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="取消提配" id="37b76d66-f860-4b7b-b32d-b5f4e8deee9e" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request>{
	"transportNum":"${再次创建配送#Response#$.data}",
	"type":"3"
	}</con:request><con:originalUri>http://10.77.0.147/scTmsWeb/scWebDelivery/cancelExecutionDepart</con:originalUri><con:assertion type="GroovyScriptAssertion" id="a6d0927f-0bed-45b5-bc11-0ace02c8f634" name="Assert node [body]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def responsemsg = context.expand( '${取消提配#Response#$.msg}' )


assert responsemsg == 'success'
</scriptText></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><entry key="csrfToken" value="${csrfToken#Response#$.data}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="数据库校验-ut_transport表状态 配送计划中" id="159b2e2c-38e0-4817-af33-a57ba6167d22"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>bu_transport</con:dbConnectionName><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://10.7.13.48:8066/bu_transport?user=admin&amp;password=PASS_VALUE</con:connectionString><con:password>9MeRMf7b15SvsjLpQFtB</con:password><con:query>Select *
From ut_transport where ut_transport.transport_num='${再次创建配送#Response#$.data}'</con:query><con:assertion type="XPath Match" id="3d25d997-7c42-472d-935d-c8e93e860fd1" name="Match content of [ut_transport.transport_status]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/ut_transport.transport_status[1]/text()</path><content>20</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="restrequest" name="执行提配2" id="d165cb1c-1631-4200-8037-921c5a2b963e"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/scWebDelivery/executionDepart" methodName="执行提配" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="执行提配2" id="87b3e451-0d95-44ca-83ad-ec29545855df" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request>{
	"transportNum":"${再次创建配送#Response#$.data}",
	"type":"3"
	}</con:request><con:originalUri>http://10.77.0.147/scTmsWeb/scWebDelivery/executionDepart</con:originalUri><con:assertion type="GroovyScriptAssertion" id="9b83ea27-361a-4e4b-98a8-c4633feda09f" name="Assert node [body]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def responsemsg = context.expand( '${执行提配2#Response#$.msg}' )


assert responsemsg == 'success'
</scriptText></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><entry key="csrfToken" value="${csrfToken#Response#$.data}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="数据库校验-ut_transport表状态 配送中" id="033fa3d3-c436-480b-910b-fea4d0dd5100"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>bu_transport</con:dbConnectionName><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://10.7.13.48:8066/bu_transport?user=admin&amp;password=PASS_VALUE</con:connectionString><con:password>9MeRMf7b15SvsjLpQFtB</con:password><con:query>Select *
From ut_transport where ut_transport.transport_num='${再次创建配送#Response#$.data}'</con:query><con:assertion type="XPath Match" id="3d25d997-7c42-472d-935d-c8e93e860fd1" name="Match content of [ut_transport.transport_status]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/ut_transport.transport_status[1]/text()</path><content>21</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:testStep type="restrequest" name="提配完成" id="81a33e4c-2c3d-4726-83ee-5450a79979a1"><con:settings/><con:config service="http://10.77.0.147" resourcePath="/scTmsWeb/scWebDelivery/finishDelivery" methodName="提配完成" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="提配完成" id="1aa25e87-cae8-495e-8e25-8c9337011b04" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="Cookie" value="session_key=1CBC43AFBCB04FBF8C77DF0AE64A3BBD_session_568040686" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>http://10.77.0.147</con:endpoint><con:request>{"transportNum":"${再次创建配送#Response#$.data}","type":"3"}</con:request><con:originalUri>http://10.77.0.147/scTmsWeb/scWebDelivery/finishDelivery</con:originalUri><con:assertion type="GroovyScriptAssertion" id="95f7840a-1554-4fdd-a645-529cdeb09ef4" name="Assert node [body]"><con:configuration><scriptText>import com.eviware.soapui.support.XmlHolder

def responsemsg = context.expand( '${提配完成#Response#$.msg}' )


assert responsemsg == 'success'
</scriptText></con:configuration></con:assertion><con:credentials><con:selectedAuthProfile>No Authorization</con:selectedAuthProfile><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:parameters><entry key="csrfToken" value="${csrfToken#Response#$.data}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>csrfToken</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="jdbc" name="数据库校验-ut_transport表状态 已配送23" id="a4659238-e262-422c-b05f-d0d43075307d"><con:settings/><con:config xsi:type="con:JdbcRequestTestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:dbConnectionName>bu_transport</con:dbConnectionName><con:driver>com.mysql.jdbc.Driver</con:driver><con:connectionString>jdbc:mysql://10.7.13.48:8066/bu_transport?user=admin&amp;password=PASS_VALUE</con:connectionString><con:password>9MeRMf7b15SvsjLpQFtB</con:password><con:query>Select *
From ut_transport where ut_transport.transport_num='${再次创建配送#Response#$.data}'</con:query><con:assertion type="XPath Match" id="3d25d997-7c42-472d-935d-c8e93e860fd1" name="Match content of [ut_transport.transport_status]"><con:configuration><path>//Results[1]/ResultSet[1]/Row[1]/ut_transport.transport_status[1]/text()</path><content>23</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:properties/></con:config></con:testStep><con:properties/><con:reportParameters/><con:breakPoints><con:testStepId>5bef41f1-580f-4331-baf0-1cac754ee534</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>449fcbc0-6daa-4bbf-8a97-7bdcb3e3f4d3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>b64c6be9-4f0c-49e8-8c07-d5ab7fa03cd1</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>212d2dba-67cc-4052-b0a0-e0c4958fcbd4</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e921955c-791b-4088-a5ac-c9bc40844d69</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>e8bf10ee-15ef-4523-bb52-72ea44b0c097</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d81ac34a-9c5f-44e9-a961-63f4a2705c1d</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d8908fe4-58ed-4537-8171-cd2ed15db69d</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>6672efca-2969-4e41-be32-c5c4b1bcef3a</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>adc167fe-32c2-4754-8edf-1f6e8846ae94</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>5622258e-4c7e-4605-aaa6-9ce4759b0aae</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>8cb31fac-6972-482a-9bb1-2c44fed69aca</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f45ebf24-2053-4e58-a8a2-d3df79c3fc9e</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>a0e0acc3-75ff-4a08-b17d-ebde8769eacb</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>2a474df1-c99f-41c9-9258-4ce3e60e0b8c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>a0a42dc8-f49b-4641-bae6-3dae3e0da626</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>10b7f2be-6835-475c-a7f5-2f5bd9dea0b3</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>7b68c912-4360-4815-aeb5-7e3b19e0e1c0</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>8aad31a1-cbe1-4678-8849-09c8299138cb</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>75807d82-6ffc-4f9e-a5e4-659bccf24a0c</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>8bae44d4-24bc-4566-b63a-d92ec3f17da6</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>d75051b6-5d50-4075-a330-005f4ad473a7</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>152bee48-3128-447b-bcf7-23ebd516f773</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>2388409c-7f13-479a-8ad6-3b5a4e9246c9</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>f72257e1-af17-4af9-9484-1e36543e87d7</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints><con:breakPoints><con:testStepId>33f9015e-b233-4ea4-b7d3-df3cffa3b3f2</con:testStepId><con:status>NONE</con:status><con:properties/></con:breakPoints></con:testCase>